(function(t){function e(e){for(var a,s,o=e[0],c=e[1],u=e[2],d=0,h=[];d<o.length;d++)s=o[d],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&h.push(r[s][0]),r[s]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);l&&l(e);while(h.length)h.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],a=!0,o=1;o<n.length;o++){var c=n[o];0!==r[c]&&(a=!1)}a&&(i.splice(e--,1),t=s(s.s=n[0]))}return t}var a={},r={app:0},i=[];function s(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=a,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(n,a,function(e){return t[e]}.bind(null,a));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var l=c;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";n("85ec")},4626:function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);var a={};n.r(a),n.d(a,"namespaced",(function(){return ot})),n.d(a,"state",(function(){return ct})),n.d(a,"mutations",(function(){return ut})),n.d(a,"actions",(function(){return lt})),n.d(a,"getters",(function(){return dt}));n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("a026"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("NavBar"),n("div",{attrs:{id:"view"}},[n("router-view")],1)],1)},s=[],o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"nav"}},[n("b-navbar",{attrs:{toggleable:"lg",type:"dark",variant:"info"}},[n("router-link",{attrs:{to:"/"}},[n("b-navbar-brand",[t._v("Chat-it")])],1),n("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),n("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[n("b-navbar-nav",[t.token?t._e():n("b-nav-item",{attrs:{to:"/login"}},[t._v("Login")])],1),n("b-navbar-nav",{staticClass:"ml-auto"},[n("b-nav-item-dropdown",{attrs:{right:""},scopedSlots:t._u([{key:"button-content",fn:function(){return[n("em",[t._v(t._s(t.name))])]},proxy:!0}])},[n("b-dropdown-item",{attrs:{href:"#"}},[t._v("Profile")]),t.token?n("b-dropdown-item",{on:{click:t.SignOut}},[t._v(" Sign Out ")]):t._e()],1)],1)],1)],1)],1)},c=[],u=n("5530"),l=n("2f62"),d={computed:Object(l["c"])("user",["name","token"]),methods:Object(u["a"])({SignOut:function(){var t=this;this.resetState().then((function(){t.$router.push({name:"LoginForm"})}))}},Object(l["b"])("user",["resetState"]))},h=d,f=(n("dfa0"),n("2877")),m=Object(f["a"])(h,o,c,!1,null,"4f7cdef2",null),p=m.exports,b={components:{NavBar:p}},v=b,g=(n("034f"),Object(f["a"])(v,i,s,!1,null,null,null)),_=g.exports,w=n("8c4f"),k=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("router-view")},C=[],y={},x=y,S=Object(f["a"])(x,k,C,!1,null,null,null),O=S.exports,E=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex h-100"},[n("div",{staticClass:"h-100 w-25 px-3 d-none d-sm-flex"},[n("ChatList",{attrs:{chatlist:t.chatlist},on:{update:t.openchat}})],1),n("div",{staticClass:"h-100 w-50 px-auto d-none d-md-flex"},[n("Chat",{attrs:{chat:t.chat,friends:t.friends},on:{update:t.openchat}})],1),n("div",{staticClass:"h-100 w-75 px-auto d-none d-sm-flex d-md-none"},[n("Chat",{attrs:{chat:t.chat,friends:t.friends},on:{update:t.openchat}})],1),n("div",{staticClass:"h-100 w-25 px-3 d-none d-md-flex"},[n("ChatStatus")],1),t.showChats?n("div",{staticClass:"h-100 w-100 px-1 d-flex d-sm-none"},[n("ChatList",{attrs:{chatlist:t.chatlist},on:{update:t.openchat}})],1):t._e(),t.chating?n("div",{staticClass:"h-100 w-100 px-1 d-flex d-sm-none"},[n("Chat",{attrs:{chat:t.chat,friends:t.friends},on:{update:t.openchat}})],1):t._e(),t.showStatus?n("div",{staticClass:"h-100 w-100 px-1 d-flex d-sm-none"},[n("ChatStatus")],1):t._e()])},j=[],T=(n("d3b7"),n("bc3a")),$=n.n(T),F=$.a.create({baseURL:"http://192.168.0.12:3000",withCredentials:!1,headers:{Accept:"application/json","Content-Type":"application/json"},timeout:1e4}),L={userLogin:function(t,e){return F.get("/login",{params:{id:t,pass:e}}).then((function(t){return t.data})).catch((function(t){console.error(t)}))},register:function(t){return F.get("/register",{params:{data:t}}).then((function(t){return t.data})).catch((function(t){console.error(t)})).finally((function(){}))},checkToken:function(t){return F.get("/checkToken",{params:{token:t}}).then((function(t){return t.data})).catch((function(t){console.error(t)}))},getFriends:function(t){return F.get("/getFriends",{params:{token:t}}).then((function(t){return t.data})).catch((function(t){console.error(t)})).finally((function(){}))},getChats:function(t){return F.get("/getChats",{params:{token:t}}).then((function(t){return t.data})).catch((function(t){console.error(t)})).finally((function(){}))},getChat:function(t){return F.get("/getChat",{params:{chatid:t}}).then((function(t){return t.data})).catch((function(t){console.error(t)})).finally((function(){}))},addMember:function(t,e,n){return F.get("/addMember",{params:{chatid:t,chatname:e,member:n}}).then((function(t){return t.data})).catch((function(t){console.error(t)})).finally((function(){}))},sentChat:function(t,e,n){return F.get("/sentChat",{params:{token:t,chatid:e,newchat:n}}).then((function(t){return t.data})).catch((function(t){console.error(t)})).finally((function(){}))},createChat:function(t,e,n,a){return F.get("/createChat",{params:{token:t,member:e,newchat:n,chatname:a}}).then((function(t){return t.data})).catch((function(t){console.error(t)})).finally((function(){}))}},M=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"h-100 w-100"},[n("b-card",{attrs:{"sub-title":"Chatname",align:"right"}},[n("b-card-text",[t._v("Chat Data")])],1)],1)},N=[],A={},R=A,P=Object(f["a"])(R,M,N,!1,null,null,null),D=P.exports,q=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"h-100 w-100"},[n("div",{staticClass:"d-flex flex-column w-100 overflow-auto noscrollbar",staticStyle:{height:"90%"}},[t._l(t.chatlist,(function(e){return n("div",{key:e.id},[n("b-list-group-item",{staticClass:"d-flex align-items-left",attrs:{href:"#"},on:{click:function(n){return t.openchat(e)}}},[n("b-avatar",{staticClass:"mr-3"}),n("span",{staticClass:"mr-auto"},[t._v(t._s(e.name))])],1)],1)})),n("div",[n("b-list-group-item",{staticClass:"d-flex align-items-left",attrs:{href:"#"},on:{click:function(e){return t.openchat({id:"",name:""})}}},[n("span",{staticClass:"mr-auto"},[t._v("new chat")])])],1)],2)])},I=[],K={props:{chatlist:{type:Array[String],required:!0}},methods:{openchat:function(t){this.$emit("update",t)}}},B=K,J=(n("74a7"),Object(f["a"])(B,q,I,!1,null,"1e1a20b6",null)),V=J.exports,U=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"h-100 w-100"},[t.showFriends?n("div",{staticClass:"h-100 w-100 friendlist"},[n("FriendList",{attrs:{friends:t.friends},on:{update:t.addMember}})],1):t._e(),n("div",[""!==t.chat.name?n("div",[t._v(t._s(t.chat.name))]):t._e(),""===t.chat.name?n("div",[t._v(t._s(t.member.join()))]):t._e(),t.showFriends?t._e():n("div",{staticClass:"friendbutton",staticStyle:{"text-align":"right",cursor:"pointer"},on:{click:function(e){t.showFriends=!t.showFriends}}},[t._v(" new member ")])]),n("div",{staticClass:"d-flex flex-column-reverse w-100 overflow-auto noscrollbar",staticStyle:{height:"80%"}},t._l(t.loadingchats,(function(e){return n("div",{key:e.id},[e.who===t.name?[n("b-card",{attrs:{"sub-title":e.who,align:"right"}},[n("b-card-text",[t._v(t._s(e.what))])],1)]:t._e(),e.who!==t.name?[n("b-card",{attrs:{"sub-title":e.who,align:"left"}},[n("b-card-text",[t._v(t._s(e.what))])],1)]:t._e()],2)})),0),n("div",{staticClass:"w-100",staticStyle:{height:"20%"}},[n("b-input-group",{staticClass:"mt-3"},[n("b-form-input",{model:{value:t.newchat,callback:function(e){t.newchat=e},expression:"newchat"}}),n("b-input-group-append",[""!==t.chat.id?[n("b-button",{attrs:{variant:"info"},on:{click:t.sentChat}},[t._v("Sent")])]:t._e(),""===t.chat.id?[n("b-button",{attrs:{variant:"info"},on:{click:t.createChat}},[t._v("Sent")])]:t._e()],2)],1)],1)])},z=[],G=(n("4160"),n("fb6a"),n("b0c0"),n("159b"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"h-100 w-100"},[t._m(0),n("div",{staticClass:"form-check d-flex flex-column w-100 overflow-auto noscrollbar",staticStyle:{height:"90%"}},t._l(t.friends,(function(e){return n("div",{key:e.id},[n("b-list-group-item",{staticClass:"d-flex align-items-left"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.selected,expression:"selected"}],staticClass:"mr-3 my-auto",attrs:{type:"checkbox",id:e.id},domProps:{value:e.id,checked:Array.isArray(t.selected)?t._i(t.selected,e.id)>-1:t.selected},on:{change:function(n){var a=t.selected,r=n.target,i=!!r.checked;if(Array.isArray(a)){var s=e.id,o=t._i(a,s);r.checked?o<0&&(t.selected=a.concat([s])):o>-1&&(t.selected=a.slice(0,o).concat(a.slice(o+1)))}else t.selected=i}}}),n("b-avatar",{staticClass:"mr-3"}),n("span",{staticClass:"mr-auto my-auto"},[t._v(t._s(e.id))])],1)],1)})),0),n("b-list-group-item",{staticClass:"align-items-center w-75 mx-auto",attrs:{href:"#"},on:{click:t.submit}},[t._v(" 加入 ")]),n("p",[t._v(t._s(t.selected))])],1)}),H=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{clss:"w-100"}},[n("p",[t._v("Member")])])}],Q={data:function(){return{selected:[]}},props:{friends:{type:Array,required:!0}},methods:{submit:function(){this.$emit("update",this.selected)}}},W=Q,X=(n("6e7d"),Object(f["a"])(W,G,H,!1,null,"3a65d5d5",null)),Y=X.exports,Z={data:function(){return{page:5,chats:[],member:[],timeid:null,newchat:"",showFriends:!1}},props:{chat:Object,friends:Array},components:{FriendList:Y},methods:{updateChat:function(){var t=this;if(""===this.chat.id)return this.chats=[],this.member=[],void clearInterval(this.timeid);L.getChat(this.chat.id).then((function(e){t.chats=e.chat.reverse(),t.member=e.member}))},sentChat:function(){""!==this.newchat&&L.sentChat(this.token,this.chat.id,this.newchat)},createChat:function(){var t=this;""!==this.newchat&&0!=this.member.length&&L.createChat(this.token,this.member,this.newchat,this.chat.name).then((function(e){t.newchat="",t.$emit("update",e)}))},addMember:function(t){var e=this;""===this.chat.id?(t.forEach((function(t){e.member.push(t)})),t.push(),this.showFriends=!1):L.addMember(this.chat.id,this.chat.name,t).then((function(){e.showFriends=!1}))}},computed:Object(u["a"])({loadingchats:function(){return this.chats.slice(-10*this.page)}},Object(l["c"])("user",["name","token"])),watch:{chat:function(){this.timeid=setInterval(this.updateChat,100)}},mounted:function(){this.timeid=setInterval(this.updateChat,100)},destroyed:function(){clearInterval(this.timeid)}},tt=Z,et=(n("e480"),Object(f["a"])(tt,U,z,!1,null,"e916673a",null)),nt=et.exports,at={data:function(){return{showFriends:!0,showChats:!1,showStatus:!1,chating:!1,chat:{id:"",name:""},friends:[],chatlist:[],timeid:null}},methods:{openchat:function(t){this.chat=t,this.chating=!0},updateList:function(){var t=this;L.getFriends(this.token).then((function(e){t.friends=e})),L.getChats(this.token).then((function(e){t.chatlist=e}))}},components:{ChatStatus:D,ChatList:V,Chat:nt},computed:Object(l["c"])("user",["name","token"]),mounted:function(){this.timeid=setInterval(this.updateList,100)},destroyed:function(){clearInterval(this.timeid)}},rt=at,it=Object(f["a"])(rt,E,j,!1,null,null,null),st=it.exports,ot=!0,ct={name:"",token:null},ut={SET_NAME:function(t,e){t.name=e},SET_TOKEN:function(t,e){t.token=e}},lt={login:function(t,e){var n=t.commit,a=e.id,r=e.pass;return L.userLogin(a,r).then((function(t){return n("SET_NAME",a),n("SET_TOKEN",t),!0})).catch((function(t){return console.log("login failed:"+t.message),!1}))},register:function(t,e){var n=t.commit;return L.register(e).then((function(t){return n("SET_NAME",e.id),n("SET_TOKEN",t),!0})).catch((function(t){return console.log("register failed:"+t.message),!1}))},resetState:function(t){var e=t.commit;return e("SET_NAME",""),e("SET_TOKEN",null),!0}},dt={getName:function(t){return t.name},getToken:function(t){return t.token}};r["default"].use(l["a"]);var ht=new l["a"].Store({state:{},mutations:{},actions:{},modules:{user:a}}),ft=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-container",[t.show?n("b-form",{on:{submit:t.onSubmit,reset:t.onReset}},[n("b-form-group",{attrs:{id:"input-group-1",label:"Login:","label-for":"input-2"}},[n("b-form-input",{attrs:{id:"input-1",placeholder:"Enter id",required:""},model:{value:t.form.id,callback:function(e){t.$set(t.form,"id",e)},expression:"form.id"}}),n("b-form-input",{attrs:{id:"input-2",placeholder:"Enter password",type:"password",required:""},model:{value:t.form.pass,callback:function(e){t.$set(t.form,"pass",e)},expression:"form.pass"}})],1),n("p",[t._v(t._s(t.name))]),n("p",[t._v(t._s(t.token))]),n("b-form-group",{attrs:{id:"input-group-2"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.ariaDescribedby;return[n("b-form-checkbox-group",{attrs:{id:"checkboxes-1","aria-describedby":a},model:{value:t.form.checked,callback:function(e){t.$set(t.form,"checked",e)},expression:"form.checked"}},[n("b-form-checkbox",{attrs:{value:"me"}},[t._v("Remember me")])],1)]}}],null,!1,1589641534)}),n("b-button",{attrs:{type:"submit",variant:"primary"}},[t._v("Submit")]),n("b-button",{attrs:{type:"reset",variant:"danger"}},[t._v("Reset")])],1):t._e(),n("b-link",{attrs:{to:{name:"RegisterForm"}}},[t._v(" Don't have an account? Register ")])],1)],1)},mt=[],pt={data:function(){return{form:{id:"",pass:"",checked:[]},show:!0}},methods:Object(u["a"])({onSubmit:function(t){var e=this;t.preventDefault(),this.login({id:this.form.id,pass:this.form.pass}).then((function(t){t&&e.$router.push({name:"ChatView"})}))},onReset:function(t){var e=this;t.preventDefault(),this.form.id="",this.form.pass="",this.form.checked=[],this.show=!1,this.$nextTick((function(){e.show=!0}))}},Object(l["b"])("user",["login"])),computed:Object(l["c"])("user",["name","token"])},bt=pt,vt=Object(f["a"])(bt,ft,mt,!1,null,null,null),gt=vt.exports,_t=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-container",[t.show?n("b-form",{on:{submit:t.onSubmit,reset:t.onReset}},[n("b-form-group",{attrs:{id:"input-group-1",label:"Register:","label-for":"input-2"}},[n("b-form-input",{attrs:{id:"input-1",placeholder:"Enter id",required:""},model:{value:t.form.id,callback:function(e){t.$set(t.form,"id",e)},expression:"form.id"}}),n("b-form-input",{attrs:{id:"input-2",placeholder:"Enter email",type:"email",required:""},model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}}),n("b-form-input",{attrs:{id:"input-3",placeholder:"Enter password",type:"password",required:""},model:{value:t.form.pass,callback:function(e){t.$set(t.form,"pass",e)},expression:"form.pass"}})],1),n("p",[t._v(t._s(t.name))]),n("p",[t._v(t._s(t.token))]),n("b-form-group",{attrs:{id:"input-group-2"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.ariaDescribedby;return[n("b-form-checkbox-group",{attrs:{id:"checkboxes-1","aria-describedby":a},model:{value:t.form.checked,callback:function(e){t.$set(t.form,"checked",e)},expression:"form.checked"}},[n("b-form-checkbox",{attrs:{value:"me"}},[t._v("Remember me")])],1)]}}],null,!1,1589641534)}),n("b-button",{attrs:{type:"submit",variant:"primary"}},[t._v("Submit")]),n("b-button",{attrs:{type:"reset",variant:"danger"}},[t._v("Reset")])],1):t._e(),n("b-link",{attrs:{to:{name:"LoginForm"}}},[t._v(" Already have an account? Login ")])],1)],1)},wt=[],kt={data:function(){return{form:{id:"",pass:"",checked:[]},show:!0}},methods:Object(u["a"])({onSubmit:function(t){var e=this;t.preventDefault(),this.register({id:this.form.id,pass:this.form.pass,email:this.form.email}).then((function(t){t&&e.$router.push({name:"Profile"})}))},onReset:function(t){var e=this;t.preventDefault(),this.form.id="",this.form.pass="",this.form.email="",this.form.checked=[],this.show=!1,this.$nextTick((function(){e.show=!0}))}},Object(l["b"])("user",["register"])),computed:Object(l["c"])("user",["name","token"])},Ct=kt,yt=Object(f["a"])(Ct,_t,wt,!1,null,null,null),xt=yt.exports;r["default"].use(w["a"]);var St=[{path:"/login",component:O,beforeEnter:function(t,e,n){ht.getters["user/getToken"]?L.checkToken(ht.getters["user/getToken"]).then((function(t){t===ht.getters["user/getName"]?n("/"):ht.dispatch("user/resetState"),n()})).catch((function(t){console.log(t.message),n()})):n()},children:[{path:"",name:"LoginForm",component:gt},{path:"registerForm",name:"RegisterForm",component:xt}]},{path:"/",name:"ChatView",component:st,props:!0,beforeEnter:function(t,e,n){ht.getters["user/getToken"]?L.checkToken(ht.getters["user/getToken"]).then((function(t){t!==ht.getters["user/getName"]?(console.log("name different"),ht.dispatch("user/resetState"),n("/login")):n()})).catch((function(t){console.log(t.message),n("/login")})):n("/login")}}],Ot=new w["a"]({mode:"history",base:"/",routes:St});Ot.beforeEach((function(t,e,n){console.log(t),n()}));var Et=Ot,jt=n("7e05");n("5b3d"),n("7db1");r["default"].use(jt["a"]),r["default"].config.productionTip=!1,new r["default"]({router:Et,store:ht,render:function(t){return t(_)}}).$mount("#app")},"6e7d":function(t,e,n){"use strict";n("4626")},7050:function(t,e,n){},"74a7":function(t,e,n){"use strict";n("90f5")},"85ec":function(t,e,n){},"90f5":function(t,e,n){},dfa0:function(t,e,n){"use strict";n("fb0a")},e480:function(t,e,n){"use strict";n("7050")},fb0a:function(t,e,n){}});
//# sourceMappingURL=app.494f2e90.js.map